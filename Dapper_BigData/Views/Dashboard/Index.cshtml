@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/UI/Index.cshtml";
}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flag-icons/css/flag-icons.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsvectormap/dist/css/jsvectormap.min.css" />


<div class="main-content-container overflow-hidden">
    <div class="card bg-white p-20 rounded-10 border border-white mb-4 py-50">
        <div class="row">
            <div class="col-xxl-3 col-md-6 col-xxxl-6">
                <div class="position-relative border-end-custom pe-10">
                    <div class="d-sm-flex align-items-center">
                        <div class="flex-grow-1">
                            <h3 class="mb-10">En Yüksek Sipariş</h3>
                            <h2 class="fs-26 fw-medium mb-0 lh-1">
                                @(((decimal)ViewBag.Stats_MaxOrderPrice).ToString("C2"))
                            </h2>
                        </div>
                        <div class="flex-shrink-0" style="margin-bottom: -25px;">
                            <div id="new_user_chart" class="chart-position"></div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center" style="margin-top: 25px;">
                        <span class="d-flex align-content-center gap-1 bg-success bg-opacity-10 border border-success" style="padding: 3px 5px;">
                            <i class="material-symbols-outlined fs-14 text-success">monetization_on</i>
                            <span class="lh-1 fs-14 text-success">Tek Seferde</span>
                        </span>
                        <p class="mb-0 fs-14 pe-3 d-block" style="margin-top: 2px;">Rekor Satış</p>
                    </div>
                </div>
            </div>

            <div class="col-xxl-3 col-md-6 col-xxxl-6">
                <div class="position-relative border-end-custom pe-10">
                    <div class="d-sm-flex align-items-center">
                        <div class="flex-grow-1">
                            <h3 class="mb-10">En Çok Satan Ürün</h3>
                            <h2 class="fs-24 fw-medium mb-0 lh-1">
                                @if (ViewBag.Stats_BestProduct != null)
                                {
                                    @ViewBag.Stats_BestProduct.ProductName
                                }
                                else
                                {
                                    <span class="fs-18">Veri Yok</span>
                                }
                            </h2>
                        </div>
                        <div class="flex-shrink-0" style="margin-bottom: -25px;">
                            <div id="active_user_chart" class="chart-position"></div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center" style="margin-top: 25px;">
                        <span class="d-flex align-content-center gap-1 bg-primary bg-opacity-10 border border-primary" style="padding: 3px 5px;">
                            <i class="material-symbols-outlined fs-14 text-primary">category</i>
                            <span class="lh-1 fs-14 text-primary">
                                @if (ViewBag.Stats_BestProduct != null)
                                {
                                    @ViewBag.Stats_BestProduct.CategoryName
                                }
                            </span>
                        </span>
                        <p class="mb-0 fs-14 pe-3 d-block" style="margin-top: 2px;">Kategorisi</p>
                    </div>
                </div>
            </div>

            <div class="col-xxl-3 col-md-6 col-xxxl-6">
                <div class="position-relative border-end-custom pe-10">
                    <div class="d-sm-flex align-items-center">
                        <div class="flex-grow-1">
                            <h3 class="mb-10">Favori Kategori</h3>
                            <h2 class="fs-26 fw-medium mb-0 lh-1">
                                @ViewBag.Stats_BestCategory
                            </h2>
                        </div>
                        <div class="flex-shrink-0" style="margin-bottom: -25px;">
                            <div id="lead_conversation_chart" class="chart-position"></div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center" style="margin-top: 25px;">
                        <span class="d-flex align-content-center gap-1 bg-warning bg-opacity-10 border border-warning" style="padding: 3px 5px;">
                            <i class="material-symbols-outlined fs-14 text-warning">star</i>
                            <span class="lh-1 fs-14 text-warning">Top 1</span>
                        </span>
                        <p class="mb-0 fs-14 pe-3 d-block" style="margin-top: 2px;">En Çok İlgi Gören</p>
                    </div>
                </div>
            </div>

            <div class="col-xxl-3 col-md-6 col-xxxl-6">
                <div class="position-relative pe-10">
                    <div class="d-sm-flex align-items-center">
                        <div class="flex-grow-1">
                            <h3 class="mb-10">Ödeme Yöntemi</h3>
                            <h2 class="fs-26 fw-medium mb-0 lh-1">
                                @ViewBag.Stats_PaymentMethod
                            </h2>
                        </div>
                        <div class="flex-shrink-0" style="margin-bottom: -25px;">
                            <div id="revenue_growth_chart" class="chart-position" style="bottom: -8px;"></div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center" style="margin-top: 25px;">
                        <span class="d-flex align-content-center gap-1 bg-info bg-opacity-10 border border-info" style="padding: 3px 5px;">
                            <i class="material-symbols-outlined fs-14 text-info">payments</i>
                            <span class="lh-1 fs-14 text-info">Popüler</span>
                        </span>
                        <p class="mb-0 fs-14 pe-3 d-block" style="margin-top: 2px;">En Sık Kullanılan</p>
                    </div>
                </div>
            </div>
        </div>
    
    
    
    </div>
    <div class="row">
        <div class="col-xxl-4 col-xxxl-6">
            <div class="card bg-white p-20 rounded-10 border border-white mb-4">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-20">
                    <h3>Most Leads</h3>

                    <div class="dropdown select-dropdown without-border">
                        <button class="dropdown-toggle bg-transparent text-secondary fs-15" data-bs-toggle="dropdown" aria-expanded="false">
                            This Month
                        </button>

                        <ul class="dropdown-menu dropdown-menu-end bg-white border-0 box-shadow rounded-10" data-simplebar>
                            <li>
                                <button class="dropdown-item text-secondary">This Day</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Week</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Month</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Year</button>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="text-center">
                    <div id="most_leads_chart2" style="max-width: 305px; margin: auto;"></div>
                </div>
                <ul class="p-0 mb-0 list-unstyled last-child-none icon-bg">
                    @if (ViewBag.TopCountries != null)
                    {
                        foreach (var item in ViewBag.TopCountries)
                        {
                            <li class="d-flex justify-content-between align-items-center border-border-color pb-10 mb-10" style="border-bottom: 1px dashed;">
                                <div class="d-flex align-items-center">
                                    <div class="text-center rounded-circle flex-shrink-0"
                                         style="width: 50px; height: 50px; background-color: #f4f6fc; display: flex; align-items: center; justify-content: center;">
                                        <img src="@item.FlagUrl"
                                             class="rounded-circle"
                                             style="width: 30px; height: 30px; object-fit: cover; box-shadow: 0 2px 5px rgba(0,0,0,0.1);"
                                             alt="@item.CountryName">
                                    </div>

                                    <span class="ms-3 fs-16 text-secondary fw-medium">@item.CountryName</span>
                                </div>

                                <span class="fs-16 fw-bold">@item.Count.ToString("N0")</span>

                                <span class="fs-16 text-muted">@Math.Round((double)item.Ratio, 0)%</span>
                            </li>
                        }
                    }
                </ul>

            </div>
        </div>



        <div class="col-xxl-4 col-xxxl-6">
            <div class="card bg-white p-20 rounded-10 border border-white mb-4">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-20">
                    <h3>Country Stats</h3>

                    <div class="dropdown select-dropdown without-border">
                        <button class="dropdown-toggle bg-transparent text-secondary fs-15" data-bs-toggle="dropdown" aria-expanded="false">
                            This Month
                        </button>

                        <ul class="dropdown-menu dropdown-menu-end bg-white border-0 box-shadow rounded-10" data-simplebar>
                            <li>
                                <button class="dropdown-item text-secondary">This Day</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Week</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Month</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Year</button>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="text-center mb-3">
                    <div id="country_stats_map2" style="height: 284px;"></div>
                </div>
                <div class="default-table-area mx-minus-1 country-stats-table">
                    <div class="table-responsive">
                        <table class="table align-middle">
                            <thead>
                                <tr>
                                    <th scope="col" class="bg-transparent py-0 ps-0">Ülke</th>
                                    <th scope="col" class="bg-transparent py-0">Kullanıcı</th>
                                    <th scope="col" class="bg-transparent py-0 pe-0">Oran</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (ViewBag.LeastCountries != null)
                                {
                                    foreach (var item in ViewBag.LeastCountries)
                                    {
                                        <tr>
                                            <td class="ps-0">
                                                <div class="d-flex align-items-center text-decoration-none">
                                                    <div class="flex-shrink-0">
                                                        <img src="@item.FlagUrl"
                                                             class="rounded-circle"
                                                             style="width: 20px; height: 20px; object-fit: cover; border: 1px solid #eee;"
                                                             alt="@item.CountryName">
                                                    </div>
                                                    <div class="flex-grow-1 ms-2">
                                                        <h3 class="fw-medium mb-0 fs-16 position-relative top-2">
                                                            @item.CountryName
                                                        </h3>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-body fw-normal">@item.Count</td>
                                            <td class="text-body fw-normal pe-0">
                                                % @Math.Round((double)item.Ratio, 2)
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>









        <div class="col-xxl-4 col-xxxl-12">
            <div class="row">
                <div class="col-xxxl-6 col-xxl-12">
                    <div class="card p-20 rounded-10 border border-white mb-4" style="background: linear-gradient(180deg, #5c4edb, #796df6) !important;">
                        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-0">
                            <h3 class="text-white">Tasks Stats</h3>

                            <div class="dropdown select-dropdown without-border">
                                <button class="dropdown-toggle down-arrow-white bg-transparent text-white fs-15" data-bs-toggle="dropdown" aria-expanded="false">
                                    Year 2025
                                </button>

                                <ul class="dropdown-menu dropdown-menu-end bg-white border-0 box-shadow rounded-10" data-simplebar>
                                    <li>
                                        <button class="dropdown-item text-secondary">Year 2025</button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item text-secondary">Year 2025</button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item text-secondary">Year 2023</button>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div id="tasks_stats_chart2" style="margin-bottom: -17px;"></div>
                    
                    
                    
                    </div>
                </div>
                <div class="col-xxxl-6 col-xxl-12">
                    <div class="card bg-white p-20 rounded-10 border border-white mb-4">
                        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-0">
                            <h3>Earning Reports</h3>

                            <div class="dropdown select-dropdown">
                                <button class="dropdown-toggle bg-transparent text-secondary fs-15" data-bs-toggle="dropdown" aria-expanded="false">
                                    This Week
                                </button>

                                <ul class="dropdown-menu dropdown-menu-end bg-white border-0 box-shadow rounded-10" data-simplebar>
                                    <li>
                                        <button class="dropdown-item text-secondary">This Day</button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item text-secondary">This Week</button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item text-secondary">This Month</button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item text-secondary">This Year</button>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div id="earning_reports_chart2" style="margin-bottom: -17px;"></div>
                    
                    </div>
                </div>
            </div>
        </div>
    </div>













    <div class="row">
        <div class="col-lg-5">
            <div class="card bg-white p-20 rounded-10 border border-white mb-4">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-20">
                    <h3>Top Customers</h3>

                    <div class="dropdown select-dropdown without-border">
                        <button class="dropdown-toggle bg-transparent text-secondary fs-15" data-bs-toggle="dropdown" aria-expanded="false">
                            This Week
                        </button>

                        <ul class="dropdown-menu dropdown-menu-end bg-white border-0 box-shadow rounded-10" data-simplebar>
                            <li>
                                <button class="dropdown-item text-secondary">This Day</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Week</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Month</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Year</button>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="default-table-area without-header table-top-customers">
                    <div class="table-responsive">
                        <table class="table align-middle">
                            <tbody>
                                @if (ViewBag.TopCustomers != null)
                                {
                                    foreach (var item in ViewBag.TopCustomers)
                                    {
                                        // Resim kontrolü
                                        string imgUrl = string.IsNullOrEmpty(item.CustomerImageUrl) ? "assets/images/user1.jpg" : "https://plus.unsplash.com/premium_photo-1677252438411-9a930d7a5168?q=80&w=880&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D";

                                        <tr>
                                            <td class="ps-0">
                                                <div class="d-flex align-items-center text-decoration-none">
                                                    <div class="flex-shrink-0">
                                                        <img src="@imgUrl" class="rounded-circle" style="width: 50px; height: 50px; object-fit: cover;" alt="user">
                                                    </div>
                                                    <div class="flex-grow-1 ms-12">
                                                        <h3 class="fw-normal">@item.CustomerName @item.CustomerSurname</h3>

                                                        <span class="fs-14 text-body fw-normal">
                                                            <i class="material-symbols-outlined fs-14 position-relative top-2 me-1">location_on</i>
                                                            @item.City / @item.Country
                                                        </span>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <a href="mailto:@item.Email" class="text-primary hover-text text-decoration-none fw-medium d-flex align-items-center justify-content-end">
                                                    <i class="material-symbols-outlined fs-18 me-1">mail</i>
                                                    Mail
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            
            
            
            </div>
        </div>
        <div class="col-lg-7">
            <div class="card bg-white rounded-10 border border-white mb-4">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 p-20">
                    <h3>Recent Leads</h3>

                    <div class="dropdown select-dropdown without-border">
                        <button class="dropdown-toggle bg-transparent text-secondary fs-15" data-bs-toggle="dropdown" aria-expanded="false">
                            This Week
                        </button>

                        <ul class="dropdown-menu dropdown-menu-end bg-white border-0 box-shadow rounded-10" data-simplebar>
                            <li>
                                <button class="dropdown-item text-secondary">This Day</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Week</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Month</button>
                            </li>
                            <li>
                                <button class="dropdown-item text-secondary">This Year</button>
                            </li>
                        </ul>
                    </div>
                </div>


                <div class="default-table-area mx-minus-1 table-recent-leads">
                    <div class="table-responsive">
                        <table class="table align-middle">
                            <thead>
                                <tr>
                                    <th scope="col" class="fw-medium">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="checkAll">
                                        </div>
                                    </th>
                                    <th scope="col" class="fw-medium">Müşteri</th>
                                    <th scope="col" class="fw-medium">Email</th>
                                    <th scope="col" class="fw-medium">Ödeme Yöntemi</th>
                                    <th scope="col" class="fw-medium">Durum</th>
                                    <th scope="col" class="fw-medium text-end">Tutar</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (ViewBag.LowBudgetCustomers != null)
                                {
                                    foreach (var item in ViewBag.LowBudgetCustomers)
                                    {
                                        // Resim kontrolü
                                        string imgUrl = string.IsNullOrEmpty(item.CustomerImageUrl) ? "assets/images/user1.jpg" : "https://plus.unsplash.com/premium_photo-1739201499542-63a08724a1cd?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NTZ8fHVzZXIlMjBwcm9maWxlJTIwaWNvbnxlbnwwfHwwfHx8MA%3D%3D";

                                        // Duruma Göre Renk Ayarı (Opsiyonel Güzellik)
                                        string badgeClass = "bg-primary text-primary"; // Varsayılan Mavi
                                        if (item.Status == "Completed") badgeClass = "bg-success text-success";
                                        else if (item.Status == "Pending") badgeClass = "bg-warning text-warning";
                                        else if (item.Status == "Cancelled") badgeClass = "bg-danger text-danger";

                                        <tr>
                                            <td class="text-body" style="width: 62px;">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox">
                                                </div>
                                            </td>
                                            <td>
                                                <a href="#" class="d-flex align-items-center text-decoration-none">
                                                    <div class="flex-shrink-0">
                                                        <img src="@imgUrl" class="rounded-circle" style="width: 50px; height: 50px; object-fit: cover;" alt="user">
                                                    </div>
                                                    <div class="flex-grow-1 ms-12">
                                                        <h3 class="fw-medium hover-text mb-0 fs-16">@item.CustomerName @item.CustomerSurname</h3>
                                                    </div>
                                                </a>
                                            </td>
                                            <td class="text-body">@item.Email</td>
                                            <td class="text-body">@item.PaymentMethod</td>
                                            <td>
                                                <span class="@badgeClass bg-opacity-10 fs-15 fw-normal d-inline-block default-badge">
                                                    @item.Status
                                                </span>
                                            </td>
                                            <td>
                                                <div class="d-flex justify-content-end">
                                                    <span class="fw-bold text-dark fs-16">@item.TotalPrice.ToString("C2")</span>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    </div>

                    <div class="d-flex justify-content-center justify-content-sm-between align-items-center text-center flex-wrap gap-2 showing-wrap pt-15 p-20">
                        <span class="fs-15">En düşük 6 kayıt gösteriliyor</span>
                    </div>
                </div>











            
            </div>
        </div>
    </div>






   
</div>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
    const getMostLeadsId = document.getElementById('most_leads_chart2');
    if (getMostLeadsId) {

        // C#'tan gelen verileri JS değişkenlerine alıyoruz
        var chartSeries = @Html.Raw(Json.Serialize(ViewBag.SeriesData));
        var chartLabels = @Html.Raw(Json.Serialize(ViewBag.LabelsData));

        var options = {
            series: chartSeries, // [55, 30...] yerine veritabanından gelen sayılar
            chart: {
                width: 300,
                type: "pie"
            },
            stroke: {
                width: 2,
                show: true
            },
            labels: chartLabels, // ["Email", "Social"...] yerine veritabanından gelen ülke isimleri
            legend: {
                show: false // İstersen true yapıp aşağıda isimleri gösterebilirsin
            },
            dataLabels: {
                enabled: true, // Pasta diliminin üstünde sayı yazsın mı?
                style: {
                    fontSize: '14px',
                    fontFamily: 'Outfit',
                },
                dropShadow: {
                    enabled: false
                }
            },
            colors: [
                "#00cae3", "#0e7aee", "#796df6", "#ffb264", "#28a745", "#dc3545", "#ffc107"
            ], // Renk sayısını biraz artırdım, ülke sayısı çok olursa renkler tekrar eder.
            tooltip: {
                y: {
                    formatter: function(val) {
                        return val + " Kişi"; // Tooltip'te % yerine Kişi yazsın
                    }
                }
            }
        };

        // Initialize and render the chart
        const chart = new ApexCharts(document.querySelector('#most_leads_chart2'), options);
        chart.render();
    }
</script>


<script src="https://cdn.jsdelivr.net/npm/jsvectormap/dist/js/jsvectormap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jsvectormap/dist/maps/world-merc.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {

        const getCountryStatsId = document.getElementById('country_stats_map2');

        if (getCountryStatsId) {
            // 1. Controller'dan gelen Marker listesini alıyoruz
            var markersFromDB = @Html.Raw(Json.Serialize(ViewBag.MapMarkers));

            var jvm = new jsVectorMap({
                map: "world_merc",
                selector: "#country_stats_map2",
                zoomButtons: true,

                // Harita yüklendiğinde boyut ayarı
                onLoaded(map) {
                    window.addEventListener("resize", () => {
                        map.updateSize();
                    });
                },

                // Harita Arka Plan Rengi (Gri tonu)
                regionStyle: {
                    initial: { fill: '#d1d4db' }
                },

                // Marker İsimlerini Göster
                labels: {
                    markers: {
                        render: (marker) => marker.name
                    }
                },

                // Marker Seçilebilirlik Ayarları
                markersSelectable: true,

                // Varsayılan olarak hepsini seçili (kırmızı) yapmak istersen:
                // selectedMarkers: markersFromDB.map((_, index) => index),

                // Controller'dan gelen veriyi buraya veriyoruz
                markers: markersFromDB,

                // Marker stilleri (Mavi normal, Kırmızı seçili/hover)
                markerStyle: {
                    initial: { fill: "#5c5cff", stroke: "#fff", "stroke-width": 2 },
                    hover:   { fill: "#ff5050" },
                    selected: { fill: "#ff5050" }
                },

                // Marker üzerindeki yazı stili
                markerLabelStyle: {
                    initial: {
                        fontFamily: "Inter",
                        fontWeight: 400,
                        fontSize: 12, // Yazı boyutu (0 yaparsan isimler görünmez)
                        fill: '#333'
                    }
                },

                // Tooltip: Üzerine gelince Sayıyı Göster
                onMarkerTooltipShow(event, tooltip, index) {
                    const markerData = markersFromDB[index];
                    tooltip.text(
                        `<strong>${markerData.name}</strong>: ${markerData.count} Ziyaretçi`
                    );
                }
            });
        }
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // HTML'deki ID'yi doğru seçiyoruz: tasks_stats_chart2
        const chartElement = document.querySelector('#tasks_stats_chart2');

        if (chartElement) {

            // 1. Controller'dan gelen verileri alıyoruz
            var orderCounts = @Html.Raw(Json.Serialize(ViewBag.MonthlyOrders));
            var productQuantities = @Html.Raw(Json.Serialize(ViewBag.MonthlyQuantities));

            var options = {
                series: [
                    {
                        name: "Sipariş Sayısı",
                        data: orderCounts // [10, 5, 20...] gibi gelir
                    },
                    {
                        name: "Satılan Ürün Adedi",
                        data: productQuantities // [50, 25, 100...] gibi gelir
                    }
                ],
                chart: {
                    height: 225,
                    type: "line",
                    toolbar: {
                        show: false
                    }
                },
                colors: [
                    "#00cae3", "#ffb264" // Mavi ve Turuncu
                ],
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: 2,
                    curve: "smooth", // Çizgileri yumuşatır (straight derseniz keskin olur)
                    dashArray: [0, 5] // İkinci çizgiyi kesikli yapar
                },
                legend: {
                    show: true, // Açıklamaları gösterelim ki neyin ne olduğu anlaşılsın
                    position: 'top',
                    horizontalAlign: 'right',
                    fontSize: '14px',
                    fontFamily: 'Outfit',
                    labels: {
                        colors: "#5b6b79" // Temanıza göre renk değişebilir
                    }
                },
                markers: {
                    size: 4,
                    hover: {
                        sizeOffset: 2
                    }
                },
                xaxis: {
                    categories: [
                        "Oca", "Şub", "Mar", "Nis", "May", "Haz",
                        "Tem", "Ağu", "Eyl", "Eki", "Kas", "Ara"
                    ],
                    axisBorder: {
                        show: true,
                        color: '#f1f1f1'
                    },
                    axisTicks: {
                        show: true,
                        color: '#f1f1f1'
                    },
                    labels: {
                        trim: false,
                        show: true,
                        style: {
                            colors: "#999",
                            fontSize: "12px",
                            fontFamily: 'Outfit',
                        }
                    }
                },
                yaxis: {
                    tickAmount: 4,
                    labels: {
                        show: true,
                        style: {
                            colors: "#999",
                            fontSize: "12px",
                            fontFamily: 'Outfit',
                        }
                    }
                },
                grid: {
                    strokeDashArray: 5,
                    borderColor: "#e0e0e0",
                },
                tooltip: {
                    theme: 'light'
                }
            };

            // Chart'ı oluştur ve render et
            const chart = new ApexCharts(chartElement, options);
            chart.render();

            // Pencere boyutu değişirse chart'ı güncelle
            window.addEventListener('resize', () => {
                chart.resize();
            });
        }
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {

        // ID'yi kontrol et: earning_reports_chart2
        const earningReportId = document.getElementById('earning_reports_chart2');

        if (earningReportId) {

            // 1. Controller'dan verileri al
            var orderData = @Html.Raw(Json.Serialize(ViewBag.MonthlyOrders));
            var revenueData = @Html.Raw(Json.Serialize(ViewBag.MonthlyRevenue));

            var options = {
                series: [
                    {
                        name: "Siparişler", // Orders
                        type: "column",
                        data: orderData // [10, 20, 5...]
                    },
                    {
                        name: "Kazanç (₺)", // Sales
                        type: "line",
                        data: revenueData // [5000, 12000, 300...]
                    }
                ],
                chart: {
                    height: 224,
                    type: "line", // Hem line hem column olduğu için ana tip line seçilir
                    toolbar: {
                        show: false
                    }
                },
                colors: [
                    "#5271f2", "#00cae3" // Sütun rengi, Çizgi rengi
                ],
                stroke: {
                    width: [0, 3], // Sütunun kenar çizgisi 0, Çizginin kalınlığı 3
                    curve: 'smooth'
                },
                plotOptions: {
                    bar: {
                        columnWidth: "45%"
                    }
                },
                legend: {
                    show: false, // Efsaneyi gizle (Tasarımda gizliydi)
                },
                xaxis: {
                    categories: [
                        "Oca", "Şub", "Mar", "Nis", "May", "Haz",
                        "Tem", "Ağu", "Eyl", "Eki", "Kas", "Ara"
                    ],
                    axisBorder: {
                        show: false,
                        color: '#e0e0e0'
                    },
                    axisTicks: {
                        show: false,
                        color: '#e0e0e0'
                    },
                    labels: {
                        show: true,
                        style: {
                            colors: "#919aa3",
                            fontSize: "14px",
                            fontFamily: 'Outfit',
                        }
                    }
                },
                yaxis: {
                    tickAmount: 4,
                    labels: {
                        show: true,
                        style: {
                            colors: "#919aa3",
                            fontSize: "14px",
                            fontFamily: 'Outfit',
                        },
                        // Para birimi formatı ekleyelim (Opsiyonel)
                        formatter: function (value) {
                            return value.toLocaleString('tr-TR', { maximumFractionDigits: 0 });
                        }
                    }
                },
                grid: {
                    strokeDashArray: 5,
                    borderColor: "#e0e0e0"
                },
                tooltip: {
                    shared: true,
                    intersect: false,
                    y: {
                        formatter: function (y) {
                            if (typeof y !== "undefined") {
                                return y.toLocaleString('tr-TR') + (this.seriesIndex === 1 ? " ₺" : " TL");
                            }
                            return y;
                        }
                    }
                }
            };

            // Initialize and render the chart
            const chart = new ApexCharts(earningReportId, options);
            chart.render();

            // Resize olayı
            window.addEventListener('resize', () => {
                chart.resize();
            });
        }
    });
</script>

